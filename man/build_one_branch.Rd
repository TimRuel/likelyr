% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/branch-generate.R
\name{build_one_branch}
\alias{build_one_branch}
\title{Build a Full Branch on the ψ-Grid (Integrated Likelihood)}
\usage{
build_one_branch(
  psi_hat_branch,
  theta_hat_branch,
  branch_cutoff,
  grid,
  eval_psi_fun,
  max_retries
)
}
\arguments{
\item{psi_hat_branch}{Numeric scalar. Branch mode ψ̂ for this ω̂ draw.}

\item{theta_hat_branch}{Numeric vector. θ̂ at ψ̂_branch.}

\item{branch_cutoff}{Numeric scalar. Log-likelihood cutoff for stopping.}

\item{grid}{A ψ-grid object created by \code{\link[=psi_grid_anchor]{psi_grid_anchor()}}.
Must contain components:
\itemize{
\item psi_mle   — ψ̂_MLE (global ψ mode)
\item increment — step size between ψ-grid points
}}

\item{eval_psi_fun}{Function of the form
\code{eval_psi_fun(psi_value, theta_init) -> list(theta_hat, branch_val)}
used to locally maximize the log-likelihood at fixed ψ.}

\item{max_retries}{Integer. Maximum number of jitter retries for
enforcing monotonic branch behavior.}
}
\value{
A tibble with columns:
\item{k}{Integer ψ-grid index relative to ψ̂_MLE}
\item{loglik}{Log-likelihood at each ψ_k}
\item{psi}{ψ-grid value}
\item{loglik_centered}{Centered loglik: loglik - max(loglik)}

with attributes:
\item{mode_index}{Index of the maximum branch loglik value}
\item{n_points}{Number of grid points in the branch}
\item{psi_MLE}{Global ψ̂_MLE}
}
\description{
Given the branch mode (ψ̂_branch, θ̂_branch), this function sweeps
outward along the ψ-grid in both directions (left and right) until
the log-likelihood falls below a supplied cutoff.

This is used for \strong{integrated likelihood branches only}; the cutoff
threshold (including any user-specified buffer) is computed upstream
in \code{\link[=generate_branches]{generate_branches()}}.
}
\keyword{internal}
